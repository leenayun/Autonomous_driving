참고 : https://blog.naver.com/suresofttech/220793847337

ECU : 자동차에 대한 다양한 모듈 

다양한 모듈들이 서로 통신을 하기 위해 비동기 직렬 통신 방식인 UART(Universal Asynchronous Receiver/Transmitter)를 사용
그러나 각 모듈이 1:1통신을 하기 때문에 모듈이 추가될 때마다 더 많은 연결선이 필요.
자동차의 공간을 너무 많이 차지하게 됨-> 자동차 무게 증가, 원가 상승


문제점 해결을 위하여 나온것이 CAN 통신

여러 개의 CAN장치가 서로 통신을 할 수 있으며 하나의 CAN 인터페이스로 여러 모듈을 제어할 수 있음
=> 연결선 수 감소, 자동차 무게 경감, 원가 하락, 효율적인 시스템 제어

-------> ISO가 국제 표준 규적으로 제정



*  CAN 통신의 특징 및 장점 

여러 개의 ECU를 병렬로 연결하며 데이터를 주고받는 통신방법.
통신선 상에 데이터를 띄어놓고 필요한 데이터에 접근


① 다중 주인(Multi Master) 통신 방식:
 CAN 버스는 다중 주인(Multi Master) 방식으로 통신하므로 통신 버스를 여러 노드(node)들이 공유하면서 언제든지 버스를 사용할 수 있습니다.
② 간단한 구조:
CAN_High, CAN_Low 두 개의 신호로 통신하므로 단 2개의 선이 필요로 합니다. 그러므로 많은 모듈이 추가되더라도 추가되는 선의 양이 적습니다.
③ 잡음에 매우 강함:
CAN BUS는 Twist Pair 2선으로 되어있어 전기적 잡음(noise)에 강해 메시지를 보호할 수 있습니다.
④ ID 값을 이용한 우선순위:
자동차의 ECU들은 고유한 ID 값을 가지고 있습니다. ID 값은 낮을수록 우선순위가 높은데, CAN에서는 여과 과정(filtering)을 통해 설정된 ID 값을 수신해 우선순위를 결정합니다. 주소가 아닌 ID 값으로 메시지 내용과 우선순위가 결정되며 이는 시스템 제어 속도와 안전성을 향상할 수 있습니다.
특히 BUS를 이용하므로 연결선 수를 대폭 줄일 수 있으며 이는 자동차의 무게와도 직결되므로 매우 중요합니다.
⑤ 고속 및 원거리 통신:
CAN 통신은 최대 1M bps에 달하는 고속 통신을 제공하며, 보통 통신 속도가 500k~ 1M bps 속도로 CAN 통신이 가능합니다. 또한, 최대 1,000m까지 원거리 통신이 가능합니다.
⑥ PLUG & PLAY 기능:
PLUG & PLAY 기능을 제공해서 CAN 제어기(controller)를 버스에 간편하게 연결하고 끊을 수가 있어서, 여러 장치를 추가하고 제거하기가 매우 쉽습니다.


*CAN 통신의 동작 방법

전체 노드를 제어하는 Master가 없어서 CAN버스에서 쉽게 데이터에 접근할 수 있다.
CAN 제어기는 CAN 버스 선이 사용 다른 제어기에 의해서 사용 중인지 확인을 합니다. 
만약 CAN 버스 선이 사용 중이지 않다면 모든 노드는 ID 값을 통해서 자신에게 필요한 메시지를 확인합니다.
이때 불필요한 메시지를 무시하게 되고 자신에게 필요한 메시지만 수신하게 됩니다.
앞에서 자동차의 ECU들은 고유한 ID 값을 가지고 있다고 했습니다. 
다중 노드가 동시에 메시지를 CAN 버스에 전송하려는 경우에는 가장 낮은 ID 값을 가진 최우선 노드가 자동으로 버스에 접근하게 됩니다.
(식별자 값이 1과 7일 경우 식별자 1의 우선순위가 더 높음) 
우선순위가 높은 메시지가 CAN 버스의 사용 권한을 보장받을 수 있으며 낮은 순위의 다른 노드들은 대기해야 하며 자동으로 다음 버스 사이클에서 재전송을 수행합니다.


